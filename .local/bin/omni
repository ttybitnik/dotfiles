#!/usr/bin/env bash

# Thanks to @branneman for sharing
# these functions idea

# If fail exit immediately
set -e

# Functions
run() {
  printf "\n>> $1 \n\n"
  $1
}

runIfExists() {
  if [ -x "$(command -v $1)" ]; then
    run "$2"
  fi
}

# Prompt for sudo password only once
sudo true

### Distros
# Arch
runIfExists "pacman" "sudo pacman -Syu"

# Debian
runIfExists "apt" "sudo apt update"
runIfExists "apt" "sudo apt upgrade -y"

# Fedora
runIfExists "dnf" "sudo dnf update -y"

# FreeBSD
runIfExists "pkg" "sudo pkg update"
runIfExists "pkg" "sudo pkg upgrade -y"

# Slackware
runIfExists "slackpkg" "sudo slackpkg update"
runIfExists "slackpkg" "sudo slackpkg upgrade-all"
runIfExists "sbocheck" "sudo sbocheck"
runIfExists "sbocheck" "sudo sboupgrade --all"

# MacOS
runIfExists "brew" "brew update"
runIfExists "brew" "brew upgrade"

# Windows
runIfExists "winget" "winget upgrade --all"

## Package managers
# Flatpak
runIfExists "flatpak" "flatpak update -y"

# Python
runIfExists "pip" "pip install --upgrade pip"
runIfExists "pip" "pip list --outdated | awk '{print $1}' | xargs -n1 pip install -U"
